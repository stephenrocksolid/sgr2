<form
  hx-post="{% url 'inventory:engine_part_add' engine.id %}"
  hx-target="#engine-parts-section"
  hx-swap="innerHTML"
  hx-on::after-request="if(event.detail.successful) document.getElementById('engine-parts-add').innerHTML = ''"
>
  {% csrf_token %}
  <div class="form-group">
    <label for="part_id">Select Part:</label>
    <select name="part_id" class="form-control" required>
      <option value="">Select a part…</option>
      {% for p in parts %}
        <option value="{{ p.id }}">{{ p.part_number }} — {{ p.name }}</option>
      {% endfor %}
    </select>
    {% if parts|length == 0 %}
      <p class="text-sm text-gray-500 mt-1">All parts are already linked to this engine.</p>
    {% endif %}
  </div>
  <div class="form-group">
    <label for="notes">Notes:</label>
    <textarea name="notes" class="form-control" rows="2" placeholder="Optional notes…"></textarea>
  </div>
  <div class="flex gap-2 mt-2">
    <button type="submit" class="btn btn-primary">Add Part</button>
    <button type="button" class="btn btn-secondary"
            hx-get="{% url 'inventory:engine_parts_partial' engine.id %}"
            hx-target="#engine-parts-section"
            hx-swap="innerHTML">
      Cancel
    </button>
  </div>
</form>
