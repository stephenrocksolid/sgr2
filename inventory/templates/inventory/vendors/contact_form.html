{% extends "base.html" %}
{% load static %}

{% block title %}{{ is_create|yesno:"Add Contact,Edit Contact" }} - {{ vendor.name }} - Spring Garden Repair{% endblock %}

{% block content %}
<div class="contact-form-page">
    <!-- Page Header -->
    <div class="contact-form-header">
        <div class="contact-form-header-left">
            <a href="{% url 'inventory:vendor_edit' vendor.pk %}" class="contact-back-link">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
                Back to {{ vendor.name }}
            </a>
            <h1 class="contact-form-title">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    {% if is_create %}
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="8.5" cy="7" r="4"></circle>
                    <line x1="20" y1="8" x2="20" y2="14"></line>
                    <line x1="23" y1="11" x2="17" y2="11"></line>
                    {% else %}
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                    {% endif %}
                </svg>
                {{ is_create|yesno:"Add Contact,Edit Contact" }}
            </h1>
        </div>
    </div>

    <!-- Form Card -->
    <div class="contact-form-card">
        <form method="post" class="contact-form">
            {% csrf_token %}
            
            {% if form.non_field_errors %}
            <div class="contact-form-error-alert">
                {% for error in form.non_field_errors %}
                <span>{{ error }}</span>
                {% endfor %}
            </div>
            {% endif %}
            
            <div class="contact-form-section">
                <div class="contact-form-section-header">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <h2>Contact Information</h2>
                </div>
                
                <div class="contact-form-grid">
                    <div class="contact-form-group contact-form-full">
                        <label class="contact-form-label">
                            Full Name
                            <span class="required-indicator">*</span>
                        </label>
                        <input type="text" 
                               name="full_name" 
                               value="{{ form.full_name.value|default_if_none:'' }}"
                               class="contact-form-input {% if form.full_name.errors %}is-invalid{% endif %}"
                               placeholder="Enter contact name..."
                               required>
                        {% if form.full_name.errors %}
                        <div class="contact-form-error">{{ form.full_name.errors.0 }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="contact-form-group">
                        <label class="contact-form-label">Email</label>
                        <div class="contact-input-with-icon">
                            <svg class="contact-input-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                                <polyline points="22,6 12,13 2,6"></polyline>
                            </svg>
                            <input type="email" 
                                   name="email" 
                                   value="{{ form.email.value|default_if_none:'' }}"
                                   class="contact-form-input contact-form-input-icon {% if form.email.errors %}is-invalid{% endif %}"
                                   placeholder="email@example.com">
                        </div>
                        {% if form.email.errors %}
                        <div class="contact-form-error">{{ form.email.errors.0 }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="contact-form-group">
                        <label class="contact-form-label">Phone</label>
                        <div class="contact-input-with-icon">
                            <svg class="contact-input-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                            <input type="text" 
                                   name="phone" 
                                   value="{{ form.phone.value|default_if_none:'' }}"
                                   class="contact-form-input contact-form-input-icon {% if form.phone.errors %}is-invalid{% endif %}"
                                   placeholder="(555) 123-4567">
                        </div>
                        {% if form.phone.errors %}
                        <div class="contact-form-error">{{ form.phone.errors.0 }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="contact-form-group contact-form-full">
                        <label class="contact-form-label">Title / Position</label>
                        <input type="text" 
                               name="title" 
                               value="{{ form.title.value|default_if_none:'' }}"
                               class="contact-form-input {% if form.title.errors %}is-invalid{% endif %}"
                               placeholder="e.g., Sales Manager, Account Rep...">
                        {% if form.title.errors %}
                        <div class="contact-form-error">{{ form.title.errors.0 }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="contact-form-section">
                <div class="contact-form-section-header">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="17" y1="10" x2="3" y2="10"></line>
                        <line x1="21" y1="6" x2="3" y2="6"></line>
                        <line x1="21" y1="14" x2="3" y2="14"></line>
                        <line x1="17" y1="18" x2="3" y2="18"></line>
                    </svg>
                    <h2>Additional Notes</h2>
                </div>
                
                <div class="contact-form-group contact-form-full">
                    <textarea name="notes" 
                              class="contact-form-textarea {% if form.notes.errors %}is-invalid{% endif %}"
                              rows="3"
                              placeholder="Add any notes about this contact...">{{ form.notes.value|default_if_none:'' }}</textarea>
                    {% if form.notes.errors %}
                    <div class="contact-form-error">{{ form.notes.errors.0 }}</div>
                    {% endif %}
                </div>
            </div>
            
            <div class="contact-form-actions">
                {% if not is_create %}
                <a href="{% url 'inventory:vendor_contact_delete_confirm' vendor.pk contact.pk %}" class="btn btn-danger-outline btn-delete">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                    Delete
                </a>
                {% endif %}
                <div class="contact-form-actions-right">
                    <a href="{% url 'inventory:vendor_edit' vendor.pk %}" class="btn btn-outline btn-cancel">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                        Cancel
                    </a>
                    <button type="submit" class="btn btn-primary btn-save">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        {{ is_create|yesno:"Create Contact,Save Changes" }}
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<style>
/* Page Layout */
.contact-form-page {
    max-width: 700px;
    margin: 0 auto;
    padding: 0 1rem;
}

/* Header */
.contact-form-header {
    margin-bottom: 1.5rem;
}

.contact-form-header-left {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.contact-back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8125rem;
    color: var(--gray-600);
    text-decoration: none;
    transition: color 0.15s ease;
}

.contact-back-link:hover {
    color: var(--primary);
}

.contact-form-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--gray-900);
    margin: 0;
}

.contact-form-title svg {
    color: var(--gray-500);
    width: 26px;
    height: 26px;
}

/* Form Card */
.contact-form-card {
    background: white;
    border: 1px solid var(--gray-200);
    border-radius: 0.5rem;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
}

.contact-form {
    padding: 0;
}

/* Error Alert */
.contact-form-error-alert {
    padding: 0.75rem 1.25rem;
    background: #fef2f2;
    border-bottom: 1px solid #fecaca;
    color: #b91c1c;
    font-size: 0.875rem;
}

/* Form Sections */
.contact-form-section {
    padding: 1.25rem 1.5rem;
    border-bottom: 1px solid var(--gray-100);
}

.contact-form-section:last-of-type {
    border-bottom: none;
}

.contact-form-section-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.contact-form-section-header svg {
    color: var(--gray-400);
}

.contact-form-section-header h2 {
    margin: 0;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--gray-700);
    text-transform: uppercase;
    letter-spacing: 0.025em;
}

/* Form Grid */
.contact-form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.contact-form-full {
    grid-column: 1 / -1;
}

/* Form Group */
.contact-form-group {
    display: flex;
    flex-direction: column;
    gap: 0.375rem;
}

.contact-form-label {
    font-size: 0.8125rem;
    font-weight: 600;
    color: var(--gray-700);
}

.required-indicator {
    color: #dc2626;
    margin-left: 0.125rem;
}

/* Form Inputs */
.contact-form-input,
.contact-form-textarea {
    padding: 0.625rem 0.75rem;
    border: 1px solid var(--gray-300);
    border-radius: 0.375rem;
    font-size: 0.875rem;
    color: var(--gray-900);
    background: white;
    transition: all 0.15s ease;
}

.contact-form-input:focus,
.contact-form-textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(74, 85, 104, 0.1);
}

.contact-form-input::placeholder,
.contact-form-textarea::placeholder {
    color: var(--gray-400);
}

.contact-form-input.is-invalid,
.contact-form-textarea.is-invalid {
    border-color: #dc2626;
}

.contact-form-input.is-invalid:focus,
.contact-form-textarea.is-invalid:focus {
    box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
}

/* Input with Icon */
.contact-input-with-icon {
    position: relative;
}

.contact-input-icon {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-400);
    pointer-events: none;
}

.contact-form-input-icon {
    padding-left: 2.25rem;
}

/* Textarea */
.contact-form-textarea {
    resize: vertical;
    min-height: 80px;
    line-height: 1.5;
}

/* Form Error */
.contact-form-error {
    font-size: 0.75rem;
    color: #dc2626;
}

/* Form Actions */
.contact-form-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: var(--gray-50);
    border-top: 1px solid var(--gray-200);
}

.contact-form-actions-right {
    display: flex;
    gap: 0.75rem;
    margin-left: auto;
}

.btn-cancel,
.btn-save,
.btn-delete {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.625rem 1.25rem;
    font-size: 0.875rem;
    font-weight: 600;
    border-radius: 0.375rem;
    cursor: pointer;
    transition: all 0.15s ease;
}

.btn-cancel {
    background: white;
    color: var(--gray-700);
    border: 1px solid var(--gray-300);
}

.btn-cancel:hover {
    background: var(--gray-50);
    border-color: var(--gray-400);
    text-decoration: none;
}

.btn-save {
    background: var(--success);
    color: white;
    border: 1px solid var(--success);
}

.btn-save:hover {
    background: #2f855a;
    border-color: #2f855a;
}

.btn-delete {
    background: white;
    color: var(--error);
    border: 1px solid var(--gray-300);
}

.btn-delete:hover {
    background: #fef2f2;
    border-color: var(--error);
    text-decoration: none;
}

/* Responsive */
@media (max-width: 640px) {
    .contact-form-grid {
        grid-template-columns: 1fr;
    }
    
    .contact-form-actions {
        flex-direction: column;
        gap: 1rem;
    }
    
    .contact-form-actions-right {
        width: 100%;
        margin-left: 0;
    }
    
    .btn-cancel,
    .btn-save,
    .btn-delete {
        width: 100%;
        justify-content: center;
    }
}
</style>
{% endblock %}
