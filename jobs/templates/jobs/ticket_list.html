{% extends "base.html" %}
{% load static %}

{% block title %}Job Tickets - Spring Garden Repair{% endblock %}

{% block content %}
<div class="ticket-list-page">
    <!-- Page Header -->
    <div class="ticket-list-header">
        <div class="ticket-list-header-left">
            <h1 class="ticket-list-title">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 5v2"></path>
                    <path d="M15 11v2"></path>
                    <path d="M15 17v2"></path>
                    <path d="M5 5h14a2 2 0 0 1 2 2v3a2 2 0 0 0 0 4v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3a2 2 0 0 0 0-4V7a2 2 0 0 1 2-2z"></path>
                </svg>
                Job Tickets
            </h1>
            <span class="ticket-list-count">{{ total_count }} total</span>
        </div>
        <div class="ticket-list-header-right">
            <a href="{% url 'jobs:ticket_create' %}" class="btn btn-primary btn-create">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                New Ticket
            </a>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="ticket-stats-row">
        <div class="ticket-stat-card">
            <div class="ticket-stat-icon ticket-stat-icon-draft">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
            </div>
            <div class="ticket-stat-info">
                <div class="ticket-stat-value">{{ stats.draft|default:0 }}</div>
                <div class="ticket-stat-label">Draft</div>
            </div>
        </div>
        <div class="ticket-stat-card">
            <div class="ticket-stat-icon ticket-stat-icon-ready-for-review">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
            </div>
            <div class="ticket-stat-info">
                <div class="ticket-stat-value">{{ stats.ready_for_review|default:0 }}</div>
                <div class="ticket-stat-label">Ready for Review</div>
            </div>
        </div>
    </div>

    <!-- Search & Filter Bar -->
    <div class="ticket-filter-bar">
        <div class="ticket-search-wrapper">
            <svg class="ticket-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <form method="get" class="ticket-search-form" id="searchForm">
                <input type="text" name="search" value="{{ search }}" class="ticket-search-input" placeholder="Search by ticket #, customer, engine...">
                <input type="hidden" name="sort" value="{{ sort }}">
                <input type="hidden" name="status" value="{{ status_filter }}">
            </form>
            {% if search %}
            <button type="button" class="ticket-search-clear" onclick="clearSearch()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            {% endif %}
        </div>
        <div class="ticket-filter-tabs">
            <a href="?{% if search %}search={{ search }}&{% endif %}sort={{ sort }}" class="ticket-filter-tab {% if not status_filter %}active{% endif %}">
                All
            </a>
            <a href="?status=draft{% if search %}&search={{ search }}{% endif %}&sort={{ sort }}" class="ticket-filter-tab {% if status_filter == 'draft' %}active{% endif %}">
                Draft
            </a>
            <a href="?status=ready_for_review{% if search %}&search={{ search }}{% endif %}&sort={{ sort }}" class="ticket-filter-tab {% if status_filter == 'ready_for_review' %}active{% endif %}">
                Ready for Review
            </a>
        </div>
    </div>

    <!-- Table -->
    <div class="ticket-table-card">
        <table class="ticket-table">
            <thead>
                <tr>
                    <th class="ticket-th-id">
                        <a href="?sort={% if sort == 'ticket_number' %}-{% endif %}ticket_number{% if search %}&search={{ search }}{% endif %}{% if status_filter %}&status={{ status_filter }}{% endif %}" class="ticket-sort-link {% if sort == 'ticket_number' or sort == '-ticket_number' %}active{% endif %}">
                            Ticket #
                            {% if sort == 'ticket_number' %}↑{% elif sort == '-ticket_number' %}↓{% endif %}
                        </a>
                    </th>
                    <th class="ticket-th-status">Status</th>
                    <th class="ticket-th-customer">
                        <a href="?sort={% if sort == 'customer__name' %}-{% endif %}customer__name{% if search %}&search={{ search }}{% endif %}{% if status_filter %}&status={{ status_filter }}{% endif %}" class="ticket-sort-link {% if sort == 'customer__name' or sort == '-customer__name' %}active{% endif %}">
                            Customer
                            {% if sort == 'customer__name' %}↑{% elif sort == '-customer__name' %}↓{% endif %}
                        </a>
                    </th>
                    <th class="ticket-th-engine">Engine</th>
                    <th class="ticket-th-components">Components</th>
                    <th class="ticket-th-store">
                        <a href="?sort={% if sort == 'store' %}-{% endif %}store{% if search %}&search={{ search }}{% endif %}{% if status_filter %}&status={{ status_filter }}{% endif %}" class="ticket-sort-link {% if sort == 'store' or sort == '-store' %}active{% endif %}">
                            Store
                            {% if sort == 'store' %}↑{% elif sort == '-store' %}↓{% endif %}
                        </a>
                    </th>
                    <th class="ticket-th-date">
                        <a href="?sort={% if sort == '-date' %}{% else %}-{% endif %}date{% if search %}&search={{ search }}{% endif %}{% if status_filter %}&status={{ status_filter }}{% endif %}" class="ticket-sort-link {% if sort == 'date' or sort == '-date' %}active{% endif %}">
                            Date
                            {% if sort == 'date' %}↑{% elif sort == '-date' %}↓{% endif %}
                        </a>
                    </th>
                    <th class="ticket-th-sales">Sales Person</th>
                    <th class="ticket-th-actions"></th>
                </tr>
            </thead>
            <tbody>
                {% for ticket in tickets %}
                <tr class="ticket-row" onclick="window.location='{% url 'jobs:ticket_detail' ticket.pk %}'">
                    <td class="ticket-cell-id">
                        <span class="ticket-number-badge">{{ ticket.ticket_number|default:"—" }}</span>
                    </td>
                    <td class="ticket-cell-status">
                        <span class="ticket-status-badge ticket-status-{{ ticket.status }}">
                            {{ ticket.get_status_display|default:"—" }}
                        </span>
                    </td>
                    <td class="ticket-cell-customer">
                        {% if ticket.customer %}
                        <span class="ticket-customer-name">{{ ticket.customer.name }}</span>
                        {% else %}
                        <span class="ticket-no-customer">No customer</span>
                        {% endif %}
                    </td>
                    <td class="ticket-cell-engine">
                        {% if ticket.engine_make or ticket.engine_model %}
                        <div class="ticket-engine-info">
                            <span class="ticket-engine-name">{{ ticket.engine_make|default:"" }} {{ ticket.engine_model|default:"" }}</span>
                            {% if ticket.engine %}
                            <span class="ticket-engine-details">{{ ticket.engine.cylinder|default:"" }}cyl{% if ticket.engine.valves_per_cyl %} / {{ ticket.engine.valves_per_cyl }}v{% endif %}</span>
                            {% endif %}
                        </div>
                        {% else %}
                        <span class="ticket-no-engine">—</span>
                        {% endif %}
                    </td>
                    <td class="ticket-cell-components">
                        <div class="ticket-components-grid">
                            {% if ticket.component_info.head %}<span class="ticket-component-tag" title="Head">H</span>{% endif %}
                            {% if ticket.component_info.block %}<span class="ticket-component-tag" title="Block">B</span>{% endif %}
                            {% if ticket.component_info.crankshaft %}<span class="ticket-component-tag" title="Crankshaft">C</span>{% endif %}
                            {% if ticket.component_info.rods %}<span class="ticket-component-tag" title="Rods">R</span>{% endif %}
                            {% if ticket.component_info.pistons %}<span class="ticket-component-tag" title="Pistons">P</span>{% endif %}
                            {% if ticket.component_info.flywheel %}<span class="ticket-component-tag" title="Flywheel">F</span>{% endif %}
                            {% if ticket.component_info.waterpump %}<span class="ticket-component-tag" title="Water Pump">W</span>{% endif %}
                            {% if ticket.component_info.manifold %}<span class="ticket-component-tag" title="Manifold">M</span>{% endif %}
                            {% if not ticket.component_info.head and not ticket.component_info.block and not ticket.component_info.crankshaft and not ticket.component_info.rods and not ticket.component_info.pistons and not ticket.component_info.flywheel and not ticket.component_info.waterpump and not ticket.component_info.manifold %}
                            <span class="ticket-no-components">—</span>
                            {% endif %}
                        </div>
                    </td>
                    <td class="ticket-cell-store">
                        {% if ticket.store %}
                        <span class="ticket-store-name">{{ ticket.store }}</span>
                        {% else %}
                        <span class="ticket-no-store">—</span>
                        {% endif %}
                    </td>
                    <td class="ticket-cell-date">
                        {% if ticket.date %}
                        <span class="ticket-date-main">{{ ticket.date|date:"M d" }}</span><span class="ticket-date-year">'{{ ticket.date|date:"y" }}</span>
                        {% else %}
                        <span class="ticket-no-date">—</span>
                        {% endif %}
                    </td>
                    <td class="ticket-cell-sales">
                        {% if ticket.sales_person %}
                        <span class="ticket-sales-name">{{ ticket.sales_person.get_full_name|default:ticket.sales_person.username }}</span>
                        {% else %}
                        <span class="ticket-no-sales">—</span>
                        {% endif %}
                    </td>
                    <td class="ticket-cell-actions" onclick="event.stopPropagation()">
                        <a href="{% url 'jobs:ticket_detail' ticket.pk %}" class="ticket-action-btn" title="View/Edit">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9" class="ticket-empty-state">
                        <div class="ticket-empty-content">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M15 5v2"></path>
                                <path d="M15 11v2"></path>
                                <path d="M15 17v2"></path>
                                <path d="M5 5h14a2 2 0 0 1 2 2v3a2 2 0 0 0 0 4v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3a2 2 0 0 0 0-4V7a2 2 0 0 1 2-2z"></path>
                            </svg>
                            <h3>No tickets found</h3>
                            <p>{% if search %}Try a different search term{% else %}Get started by creating your first ticket{% endif %}</p>
                            {% if not search %}
                            <a href="{% url 'jobs:ticket_create' %}" class="btn btn-primary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Create Ticket
                            </a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    {% if page_obj.has_other_pages %}
    <div class="ticket-pagination">
        <div class="ticket-pagination-info">
            Showing {{ page_obj.start_index }}-{{ page_obj.end_index }} of {{ total_count }}
        </div>
        <div class="ticket-pagination-controls">
            {% if page_obj.has_previous %}
            <a href="?{% if search %}search={{ search }}&{% endif %}{% if status_filter %}status={{ status_filter }}&{% endif %}sort={{ sort }}&page=1" class="ticket-page-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="11 17 6 12 11 7"></polyline>
                    <polyline points="18 17 13 12 18 7"></polyline>
                </svg>
            </a>
            <a href="?{% if search %}search={{ search }}&{% endif %}{% if status_filter %}status={{ status_filter }}&{% endif %}sort={{ sort }}&page={{ page_obj.previous_page_number }}" class="ticket-page-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </a>
            {% endif %}
            
            <span class="ticket-page-current">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
            
            {% if page_obj.has_next %}
            <a href="?{% if search %}search={{ search }}&{% endif %}{% if status_filter %}status={{ status_filter }}&{% endif %}sort={{ sort }}&page={{ page_obj.next_page_number }}" class="ticket-page-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </a>
            <a href="?{% if search %}search={{ search }}&{% endif %}{% if status_filter %}status={{ status_filter }}&{% endif %}sort={{ sort }}&page={{ page_obj.paginator.num_pages }}" class="ticket-page-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="13 17 18 12 13 7"></polyline>
                    <polyline points="6 17 11 12 6 7"></polyline>
                </svg>
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>

<style>
/* Page Layout */
.ticket-list-page {
    max-width: calc(100% - 2rem);
    margin: 0 auto;
    padding: 0 1rem;
    margin-top: -1.25rem;
}

/* Header */
.ticket-list-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
}

.ticket-list-header-left {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.ticket-list-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--gray-900);
    margin: 0;
}

.ticket-list-title svg {
    color: var(--gray-500);
    width: 26px;
    height: 26px;
}

.ticket-list-count {
    padding: 0.25rem 0.5rem;
    background: var(--gray-100);
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--gray-600);
}

.btn-create {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 1rem;
    font-size: 0.8125rem;
    font-weight: 600;
}

.btn-create svg {
    width: 14px;
    height: 14px;
}

/* Stats Row */
.ticket-stats-row {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
    margin-bottom: 0.75rem;
}

.ticket-stat-card {
    display: flex;
    align-items: center;
    gap: 0.625rem;
    padding: 0.5rem 0.875rem;
    background: white;
    border: 1px solid var(--gray-200);
    border-radius: 0.375rem;
    transition: all 0.15s ease;
}

.ticket-stat-card:hover {
    border-color: var(--gray-300);
}

.ticket-stat-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: 0.375rem;
    flex-shrink: 0;
}

.ticket-stat-icon svg {
    width: 16px;
    height: 16px;
}

.ticket-stat-icon-draft {
    background: var(--gray-100);
    color: var(--gray-600);
}

.ticket-stat-icon-ready-for-review {
    background: #fef3c7;
    color: #92400e;
}

.ticket-stat-value {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--gray-900);
    line-height: 1;
}

.ticket-stat-label {
    font-size: 0.6875rem;
    color: var(--gray-500);
    text-transform: uppercase;
    letter-spacing: 0.025em;
}

/* Filter Bar */
.ticket-filter-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: white;
    border: 1px solid var(--gray-200);
    border-radius: 0.375rem;
}

.ticket-search-wrapper {
    position: relative;
    flex: 1;
    max-width: 320px;
}

.ticket-search-icon {
    position: absolute;
    left: 0.625rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-400);
    pointer-events: none;
    width: 14px;
    height: 14px;
}

.ticket-search-form {
    width: 100%;
}

.ticket-search-input {
    width: 100%;
    padding: 0.375rem 2rem 0.375rem 2rem;
    border: 1px solid var(--gray-300);
    border-radius: 0.25rem;
    font-size: 0.8125rem;
    background: var(--gray-50);
    transition: all 0.15s ease;
}

.ticket-search-input:focus {
    outline: none;
    background: white;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(74, 85, 104, 0.1);
}

.ticket-search-clear {
    position: absolute;
    right: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    padding: 0;
    border: none;
    background: var(--gray-300);
    border-radius: 50%;
    color: var(--gray-600);
    cursor: pointer;
    transition: all 0.15s ease;
}

.ticket-search-clear:hover {
    background: var(--gray-400);
    color: var(--gray-800);
}

.ticket-filter-tabs {
    display: flex;
    gap: 0.125rem;
}

.ticket-filter-tab {
    padding: 0.375rem 0.75rem;
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--gray-600);
    text-decoration: none;
    border-radius: 0.25rem;
    transition: all 0.15s ease;
}

.ticket-filter-tab:hover {
    background: var(--gray-100);
    color: var(--gray-900);
}

.ticket-filter-tab.active {
    background: var(--primary);
    color: white;
}

/* Table Card */
.ticket-table-card {
    background: white;
    border: 1px solid var(--gray-200);
    border-radius: 0.375rem;
    overflow: auto;
    max-height: calc(100vh - 280px);
}

.ticket-table {
    width: 100%;
    border-collapse: collapse;
}

.ticket-table thead {
    background: var(--gray-50);
    position: sticky;
    top: 0;
    z-index: 10;
}

.ticket-table th {
    padding: 0.5rem 0.75rem;
    text-align: left;
    font-size: 0.625rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--gray-500);
    border-bottom: 1px solid var(--gray-200);
    background: var(--gray-50);
    white-space: nowrap;
}

.ticket-sort-link {
    color: var(--gray-500);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
}

.ticket-sort-link:hover,
.ticket-sort-link.active {
    color: var(--gray-900);
}

.ticket-th-id { width: 90px; }
.ticket-th-status { width: 90px; }
.ticket-th-customer { min-width: 140px; }
.ticket-th-engine { min-width: 150px; }
.ticket-th-components { width: 140px; }
.ticket-th-store { width: 100px; }
.ticket-th-date { width: 80px; }
.ticket-th-sales { width: 120px; }
.ticket-th-actions { width: 40px; }

/* Table Rows */
.ticket-row {
    cursor: pointer;
    transition: background 0.1s ease;
}

.ticket-row:hover {
    background: var(--gray-50);
}

.ticket-table td {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid var(--gray-100);
    vertical-align: middle;
    font-size: 0.8125rem;
}

.ticket-row:last-child td {
    border-bottom: none;
}

/* Cell Styles */
.ticket-cell-id {
    display: flex;
    align-items: center;
    gap: 0.375rem;
}

.ticket-number-badge {
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.8125rem;
    font-weight: 600;
    color: var(--gray-900);
    white-space: nowrap;
}

/* Status Badge */
.ticket-status-badge {
    display: inline-flex;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.625rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.025em;
    white-space: nowrap;
}

.ticket-status-draft { background: var(--gray-100); color: var(--gray-700); }
.ticket-status-ready_for_review { background: #fef3c7; color: #92400e; }

/* Customer Cell */
.ticket-customer-name {
    font-weight: 500;
    color: var(--gray-900);
}

.ticket-no-customer {
    color: var(--gray-400);
    font-style: italic;
    font-size: 0.75rem;
}

/* Engine Cell */
.ticket-engine-info {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
}

.ticket-engine-name {
    font-weight: 500;
    color: var(--gray-900);
    white-space: nowrap;
}

.ticket-engine-details {
    font-size: 0.6875rem;
    color: var(--gray-500);
}

.ticket-no-engine {
    color: var(--gray-400);
}

/* Components Cell */
.ticket-components-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
}

.ticket-component-tag {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    height: 20px;
    padding: 0 0.25rem;
    background: var(--gray-100);
    border-radius: 0.25rem;
    font-size: 0.625rem;
    font-weight: 600;
    color: var(--gray-700);
}

.ticket-no-components {
    color: var(--gray-400);
}

/* Store Cell */
.ticket-store-name {
    font-weight: 500;
    color: var(--gray-900);
}

.ticket-no-store {
    color: var(--gray-400);
}

/* Date Cell */
.ticket-cell-date {
    white-space: nowrap;
}

.ticket-date-main {
    font-weight: 500;
    color: var(--gray-900);
}

.ticket-date-year {
    font-size: 0.6875rem;
    color: var(--gray-500);
    margin-left: 0.25rem;
}

.ticket-no-date {
    color: var(--gray-400);
}

/* Sales Cell */
.ticket-sales-name {
    font-weight: 500;
    color: var(--gray-900);
    white-space: nowrap;
}

.ticket-no-sales {
    color: var(--gray-400);
}

/* Action Button */
.ticket-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 0.25rem;
    color: var(--gray-400);
    transition: all 0.15s ease;
}

.ticket-action-btn svg {
    width: 14px;
    height: 14px;
}

.ticket-action-btn:hover {
    background: var(--gray-100);
    color: var(--gray-700);
}

/* Empty State */
.ticket-empty-state {
    padding: 3rem 2rem !important;
    text-align: center;
}

.ticket-empty-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}

.ticket-empty-content svg {
    color: var(--gray-300);
    width: 40px;
    height: 40px;
}

.ticket-empty-content h3 {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--gray-700);
}

.ticket-empty-content p {
    margin: 0;
    font-size: 0.875rem;
    color: var(--gray-500);
}

.ticket-empty-content .btn {
    margin-top: 0.5rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

/* Pagination */
.ticket-pagination {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: white;
    border: 1px solid var(--gray-200);
    border-radius: 0.375rem;
}

.ticket-pagination-info {
    font-size: 0.75rem;
    color: var(--gray-600);
}

.ticket-pagination-controls {
    display: flex;
    align-items: center;
    gap: 0.375rem;
}

.ticket-page-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border: 1px solid var(--gray-300);
    border-radius: 0.25rem;
    color: var(--gray-600);
    background: white;
    text-decoration: none;
    transition: all 0.15s ease;
}

.ticket-page-btn svg {
    width: 12px;
    height: 12px;
}

.ticket-page-btn:hover {
    background: var(--gray-50);
    border-color: var(--gray-400);
}

.ticket-page-current {
    padding: 0 0.625rem;
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--gray-700);
}

/* Responsive */
@media (max-width: 1024px) {
    .ticket-stats-row {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 480px) {
    .ticket-stats-row {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .ticket-list-header {
        flex-direction: column;
        align-items: stretch;
        gap: 0.75rem;
    }
    
    .ticket-filter-bar {
        flex-direction: column;
        align-items: stretch;
    }
    
    .ticket-search-wrapper {
        max-width: none;
    }
    
    .ticket-filter-tabs {
        overflow-x: auto;
        padding-bottom: 0.25rem;
    }
    
    .ticket-th-engine,
    .ticket-cell-engine,
    .ticket-th-sales,
    .ticket-cell-sales {
        display: none;
    }
}

@media (max-width: 640px) {
    .ticket-pagination {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .ticket-th-components,
    .ticket-cell-components,
    .ticket-th-store,
    .ticket-cell-store {
        display: none;
    }
}
</style>

<script>
// Submit search on enter
document.querySelector('.ticket-search-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        this.form.submit();
    }
});

// Clear search
function clearSearch() {
    const form = document.getElementById('searchForm');
    const searchInput = form.querySelector('input[name="search"]');
    searchInput.value = '';
    form.submit();
}
</script>
{% endblock %}
