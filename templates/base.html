<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Spring Garden Repair Part Manager{% endblock %}</title>
    
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    
    <!-- CSRF Token for HTMX -->
    <meta name="csrf-token" content="{{ csrf_token }}">
    <script>
        // Configure HTMX to include CSRF token
        document.addEventListener('DOMContentLoaded', function() {
            htmx.on('htmx:configRequest', function(evt) {
                evt.detail.headers['X-CSRFToken'] = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
            });
        });
    </script>
    
    {% load static %}
    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'core/styles.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body class="{% if not request.user.is_authenticated %}login-body{% else %}app-body{% endif %}">
    {% if request.user.is_authenticated %}
        <!-- Sidebar for authenticated users -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="sidebar-title">SGR Part Manager</h1>
            </div>
            <nav class="sidebar-nav">
                <ul class="sidebar-nav-list">
                    <li class="sidebar-nav-item">
                        <a href="{% url 'inventory:machines_list' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">Machines</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="{% url 'inventory:engines_list' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">Engines</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="{% url 'inventory:parts_list' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">Parts</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item sidebar-divider">
                        <a href="{% url 'inventory:sg_engines_list' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">SG Engines</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="{% url 'inventory:vendor_index' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">Vendors</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item sidebar-divider">
                        <a href="{% url 'imports:index' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">Imports</span>
                        </a>
                    </li>
                    <li class="sidebar-nav-item">
                        <a href="{% url 'imports:unmatched_index' %}" class="sidebar-nav-link">
                            <span class="sidebar-nav-text">Unmatched</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="mt-auto">
                <div class="sidebar-nav-item sidebar-divider">
                    <form action="{% url 'logout' %}" method="post" style="margin: 0;">
                        {% csrf_token %}
                        <button type="submit" class="sidebar-nav-link" style="width: 100%; background: none; border: none; text-align: left; cursor: pointer; font-family: inherit; font-size: inherit; font-weight: inherit;">
                            <span class="sidebar-nav-text">Logout</span>
                        </button>
                    </form>
                </div>
            </div>
        </aside>
    {% endif %}

    <!-- Main Content Area -->
    <main class="{% if request.user.is_authenticated %}main-content{% else %}login-main{% endif %}">
        <div class="{% if request.user.is_authenticated %}main-content-container{% else %}login-container{% endif %}">
            {% if messages %}
                <div class="messages">
                    {% for message in messages %}
                        <div class="message message-{{ message.tags }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            {% block content %}
            {% endblock %}
        </div>
    </main>

    <!-- Scripts -->
    {% block extra_js %}{% endblock %}
</body>
</html>